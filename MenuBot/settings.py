"""
Django settings for MenuBot project.

Generated by 'django-admin startproject' using Django 5.1.6.

For more information on this file, see
https://docs.djangoproject.com/en/5.1/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.1/ref/settings/
"""

import os
from collections import OrderedDict

# Build paths inside the project like this: BASE_DIR / 'subdir'.
PROJECT_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
# BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.1/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-4+$78uo)&2vi!!2nyrh1@x=#)=2@ed_hr!888_)_^mf_l#ztp='

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = ['*']

# Application definition

THIRD_PARTY_APPS = [
    "rest_framework",
    "corsheaders",
    "phonenumber_field",
    "constance",
    "constance.backends.database",
    # "django_celery_beat",
    "django.contrib.postgres",
    "localized_fields",
    'django_cleanup.apps.CleanupConfig',
    'adminsortable2',
]

DJANGO_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]

LOCAL_APPS = [
    'customers.apps.CustomersConfig',
    'menu.apps.MenuConfig',
]

INSTALLED_APPS = DJANGO_APPS + THIRD_PARTY_APPS + LOCAL_APPS

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'common.middleware.LanguageHeaderMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'MenuBot.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'MenuBot.wsgi.application'


REST_FRAMEWORK = {
    'COERCE_DECIMAL_TO_STRING': False,
}

APPEND_SLASH = False


REDIS_HOST = os.getenv("REDIS_HOST")
REDIS_PORT = os.getenv("REDIS_PORT")
REDIS_DB_FOR_CACHE = os.getenv("REDIS_DB_FOR_CACHE")
REDIS_AS_CACHE_URL = "redis://{host}:{port}/{db_index}".format(
    host=REDIS_HOST,
    port=REDIS_PORT,
    db_index=REDIS_DB_FOR_CACHE,
)
REDIS_DB_FOR_CELERY = os.getenv("REDIS_DB_FOR_CELERY", "0")
REDIS_AS_BROKER_URL = "redis://{host}:{port}/{db_index}".format(
    host=REDIS_HOST,
    port=REDIS_PORT,
    db_index=REDIS_DB_FOR_CELERY,
)

CACHES = {
    "default": {
        "BACKEND": "django_redis.cache.RedisCache",
        "LOCATION": REDIS_AS_CACHE_URL,
        "OPTIONS": {
            "CLIENT_CLASS": "django_redis.client.DefaultClient",
        }
    }
}


# Database
# https://docs.djangoproject.com/en/5.1/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'psqlextra.backend',
        "NAME": os.getenv("DB_NAME"),
        "USER": os.getenv("DB_USER"),
        "PASSWORD": os.getenv("DB_PASSWORD"),
        "HOST": os.getenv("DB_HOST"),
        "PORT": os.getenv("DB_PORT"),
    }
}


# Password validation
# https://docs.djangoproject.com/en/5.1/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/5.1/topics/i18n/

LANGUAGE_CODE = 'ru'
LANGUAGES = (
    ("ru", "–†—É—Å—Å–∫–∏–π"),
    ("uz", "–£–∑–±–µ–∫—Å–∫–∏–π"),
)

TIME_ZONE = 'Asia/Qyzylorda'
USE_I18N = True
USE_L10N = True
USE_TZ = False


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.1/howto/static-files/

STATIC_URL = "static/"
STATIC_ROOT = os.path.join(PROJECT_DIR, "..", 'static')
MEDIA_URL = "media/"
MEDIA_ROOT = os.path.join(PROJECT_DIR, "..", "media")

# Default primary key field type
# https://docs.djangoproject.com/en/5.1/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'


CELERY_BROKER_URL = REDIS_AS_BROKER_URL
# CELERY_BEAT_SCHEDULER = "django_celery_beat.schedulers.DatabaseScheduler"

CELERY_RESULT_EXTENDED = False
CELERY_RESULT_EXPIRES = 3600
CELERY_ALWAYS_EAGER = False
CELERY_ACKS_LATE = True
CELERY_TASK_PUBLISH_RETRY = False
CELERY_DISABLE_RATE_LIMITS = False
CELERY_TASK_TRACK_STARTED = True


CONSTANCE_BACKEND = 'constance.backends.database.DatabaseBackend'
CONSTANCE_CONFIG = {
    "POPULAR_CATEGORY_RU": ("–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ", '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (RU)'),
    "POPULAR_CATEGORY_UZ": ("Mashhur", '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (UZ)'),
    "START_TIME": ("08:00", '–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è'),
    "END_TIME": ("22:30", '–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è'),
    "ADDRESS_MESSAGE_RU": ("–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ", '–ü—Ä–æ—Å—å–±–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å (RU)'),
    "ADDRESS_MESSAGE_UZ": ("Joylashuvingizni yuboring", '–ü—Ä–æ—Å—å–±–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å (UZ)'),
    "EDIT_LANGUAGE_BUTTON_RU": ("–ò–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞", '–ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞" (RU)'),
    "EDIT_LANGUAGE_BUTTON_UZ": ("Interfeys tilini o'zgartiring", '–ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞" (UZ)'),
    "EDIT_PHONE_BUTTON_RU": ("–ò–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞", '–ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"" (RU)'),
    "EDIT_PHONE_BUTTON_UZ": ("Telefon raqamini o'zgartiring", '–ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"" (UZ)'),
    "GET_BACK_BUTTON_RU": ("üîô–ù–∞–∑–∞–¥", '–ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (RU)'),
    "GET_BACK_BUTTON_UZ": ("üîôOrqaga", '–ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (UZ)'),
    "LANGUAGE_BUTTON_RU": ("üá∑üá∫–†—É—Å—Å–∫–∏–π", '–ö–Ω–æ–ø–∫–∞ "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫" (RU)'),
    "LANGUAGE_BUTTON_UZ": ("üá∫üáøO'zbek", '–ö–Ω–æ–ø–∫–∞ "–£–∑–±–µ–∫—Å–∫–∏–π —è–∑—ã–∫" (UZ)'),
    "LANGUAGES_MESSAGE": ('–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / Tilni tanlang', '–ü—Ä–æ—Å—å–±–∞ –≤—ã–±—Ä–∞—Ç—å —è–∑—ã–∫'),
    "LANGUAGES_MESSAGE_RU": ('–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫', '–ü—Ä–æ—Å—å–±–∞ –≤—ã–±—Ä–∞—Ç—å —è–∑—ã–∫ (RU)'),
    "LANGUAGES_MESSAGE_UZ": ('Tilni tanlang', '–ü—Ä–æ—Å—å–±–∞ –≤—ã–±—Ä–∞—Ç—å —è–∑—ã–∫ (UZ)'),
    "MAIN_MESSAGE_RU": ('–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üç¥–ú–µ–Ω—é"', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤ –º–µ–Ω—é (RU)'),
    "MAIN_MESSAGE_UZ": ('Buyurtma berish uchun "üç¥Menyu" tugmasini bosing', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤ –º–µ–Ω—é (UZ)'),
    "MENU_BUTTON_RU": ('üç¥–ú–µ–Ω—é', '–ö–Ω–æ–ø–∫–∞ "–ú–µ–Ω—é" (RU)'),
    "MENU_BUTTON_UZ": ('üç¥Menyu', '–ö–Ω–æ–ø–∫–∞ "–ú–µ–Ω—é" (UZ)'),
    "MENU_MESSAGE_RU": ('–ó–∞–∫–∞–∂–∏—Ç–µ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é', '–ü—Ä–æ—Å—å–±–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é (RU)'),
    "MENU_MESSAGE_UZ": ('Interaktiv menyudan buyurtma bering', '–ü—Ä–æ—Å—å–±–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é (UZ)'),
    "PHONE_MESSAGE_RU": ('–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "üìû–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç"', '–ü—Ä–æ—Å—å–±–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç" (RU)'),
    "PHONE_MESSAGE_UZ": ('"üìûKontaktni yuboring" tugmasini bosing', '–ü—Ä–æ—Å—å–±–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç" (UZ)'),
    "SET_ADDRESS_BUTTON_RU": ('üìç–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º', '–ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º" (RU)'),
    "SET_ADDRESS_BUTTON_UZ": ('üìçJoylashuvni ulashish', '–ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º" (UZ)'),
    "SET_PHONE_RU": ("üìû–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç", '–ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç" (RU)'),
    "SET_PHONE_UZ": ("üìûKontaktni yuboring", '–ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç" (UZ)'),
    "SETTINGS_BUTTON_RU": ('‚öôÔ∏è–ù–∞—Å—Ç—Ä–æ–π–∫–∏', '–ö–Ω–æ–ø–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" (RU)'),
    "SETTINGS_BUTTON_UZ": ('‚öôÔ∏èSozlamalar', '–ö–Ω–æ–ø–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" (UZ)'),
    "SETTINGS_MESSAGE_RU": ('–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" (RU)'),
    "SETTINGS_MESSAGE_UZ": ('Sozlamani tanlang', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" (UZ)'),
    "WEB_APP_URL": ('https://miraapa.uz', '–°—Å—ã–ª–∫–∞ –Ω–∞ web app'),
    "WEB_APP_BUTTON_RU": ('–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é', '–ö–Ω–æ–ø–∫–∞ "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é" (RU)'),
    "WEB_APP_BUTTON_UZ": ('Interaktiv menyu', '–ö–Ω–æ–ø–∫–∞ "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é" (UZ)'),
    "NOT_IN_DELIVERY_ZONE_RU": ('–í–∞—à –∞–¥—Ä–µ—Å –≤–Ω–µ –∑–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤–Ω–µ –∑–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏ (RU)'),
    "NOT_IN_DELIVERY_ZONE_UZ": ('Sizning manzilingiz yetkazib berish hududidan tashqarida', '–°–æ–æ–±—â–µ–Ω–∏–µ –≤–Ω–µ –∑–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏ (UZ)'),
    "USE_MENU_BUTTON_RU": ('–û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é', '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é (RU)'),
    "USE_MENU_BUTTON_UZ": ('Interaktiv menyuni oching', '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é (UZ)'),
    "BILL_INITIAL_RU": ('–ù–æ–≤—ã–π –∑–∞–∫–∞–∑', '–°—á–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (RU)'),
    "BILL_INITIAL_UZ": ('Yangi buyurtma', '–°—á–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (UZ)'),
    "BILL_TOTAL_RU": ('–ò—Ç–æ–≥–æ', '–°—á–µ—Ç –∏—Ç–æ–≥–æ (RU)'),
    "BILL_TOTAL_UZ": ('Jami', '–°—á–µ—Ç –∏—Ç–æ–≥–æ (UZ)'),
    "BILL_FINAL_RU": ('–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –∑–∞–∫–∞–∑!\n–û–ø–µ—Ä–∞—Ç–æ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.', '–°—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (RU)'),
    "BILL_FINAL_UZ": ("Buyurtmangiz uchun rahmat!\nTez orada operator siz bilan bog'lanadi.", '–°—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (UZ)'),
}
CONSTANCE_CONFIG_FIELDSETS = OrderedDict([
    ("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ WebView",(
        "POPULAR_CATEGORY_RU",
        "POPULAR_CATEGORY_UZ",
        "START_TIME",
        "END_TIME",
    )),
    ("–°—á–µ—Ç. –¢–µ–∫—Å—Ç",(
        "BILL_INITIAL_RU",
        "BILL_INITIAL_UZ",
        "BILL_TOTAL_RU",
        "BILL_TOTAL_UZ",
        "BILL_FINAL_RU",
        "BILL_FINAL_UZ",
    )),
    ("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞",(
        "ADDRESS_MESSAGE_RU",
        "ADDRESS_MESSAGE_UZ",
        "EDIT_LANGUAGE_BUTTON_RU",
        "EDIT_LANGUAGE_BUTTON_UZ",
        "EDIT_PHONE_BUTTON_RU",
        "EDIT_PHONE_BUTTON_UZ",
        "GET_BACK_BUTTON_RU",
        "GET_BACK_BUTTON_UZ",
        "LANGUAGE_BUTTON_RU",
        "LANGUAGE_BUTTON_UZ",
        "LANGUAGES_MESSAGE",
        "LANGUAGES_MESSAGE_RU",
        "LANGUAGES_MESSAGE_UZ",
        "MAIN_MESSAGE_RU",
        "MAIN_MESSAGE_UZ",
        "MENU_BUTTON_RU",
        "MENU_BUTTON_UZ",
        "MENU_MESSAGE_RU",
        "MENU_MESSAGE_UZ",
        "PHONE_MESSAGE_RU",
        "PHONE_MESSAGE_UZ",
        "SET_ADDRESS_BUTTON_RU",
        "SET_ADDRESS_BUTTON_UZ",
        "SET_PHONE_RU",
        "SET_PHONE_UZ",
        "SETTINGS_BUTTON_RU",
        "SETTINGS_BUTTON_UZ",
        "SETTINGS_MESSAGE_RU",
        "SETTINGS_MESSAGE_UZ",
        "WEB_APP_URL",
        "WEB_APP_BUTTON_RU",
        "WEB_APP_BUTTON_UZ",
        "NOT_IN_DELIVERY_ZONE_RU",
        "NOT_IN_DELIVERY_ZONE_UZ",
        "USE_MENU_BUTTON_RU",
        "USE_MENU_BUTTON_UZ",
    ))
])
CONSTANCE_IGNORE_ADMIN_VERSION_CHECK = True


CORS_ALLOW_ALL_ORIGINS = True
CORS_ALLOW_CREDENTIALS = True
CORS_ALLOWED_ORIGINS = [
    'http://localhost:8000',
    'http://127.0.0.1:8000'
]
CORS_ALLOW_HEADERS = [
    'access-control-allow-origin',
    'accept',
    'accept-encoding',
    'accept-language',
    'authorization',
    'content-type',
    'dnt',
    'origin',
    'user-agent',
    'x-csrftoken',
    'x-requested-with',
    'cookie'
]

CSRF_TRUSTED_ORIGINS = ['https://miraapa.uz', 'https://www.miraapa.uz']
